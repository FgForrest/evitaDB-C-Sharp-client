syntax = "proto3";

package io.evitadb.externalApi.grpc.generated;
option java_multiple_files = true;
option csharp_namespace = "EvitaDB";

import "google/protobuf/wrappers.proto";
import "GrpcEntity.proto";
import "GrpcEvitaDataTypes.proto";
import "GrpcEnums.proto";

message GrpcHistogram {
  GrpcBigDecimal min = 1;
  GrpcBigDecimal max = 2;
  int32 overallCount = 3;
  message GrpcBucket {
    int32 index = 1;
    GrpcBigDecimal threshold = 2;
    int32 occurrences = 3;
  }
  repeated GrpcBucket buckets = 4;
}

message GrpcFacetGroupStatisticsType {
  map<int32, GrpcFacetGroupStatistics> facetGroupStatistics = 1;
}

message GrpcFacetGroupStatistics {
  string referenceName = 1;
  GrpcEntityReference groupEntityReference = 2;
  GrpcSealedEntity groupEntity = 3;
  int32 count = 4;
  repeated GrpcFacetStatistics facetStatistics = 5;
}

message GrpcFacetStatistics {
  GrpcEntityReference facetEntityReference = 1;
  GrpcSealedEntity facetEntity = 2;
  bool requested = 3;
  int32 count = 4;
  google.protobuf.Int32Value impact = 5;
  google.protobuf.Int32Value matchCount = 6;
}

message GrpcHierarchy {
  map<string, GrpcLevelInfos> hierarchy = 1;
}

message GrpcLevelInfos {
  repeated GrpcLevelInfo levelInfos = 1;
}

message GrpcLevelInfo {
  GrpcEntityReference entityReference = 1;
  GrpcSealedEntity entity = 2;
  google.protobuf.Int32Value queriedEntityCount = 3;
  google.protobuf.Int32Value childrenCount = 4;
  repeated GrpcLevelInfo items = 5;
}

message GrpcQueryTelemetry {
  GrpcQueryPhase operation = 1;
  int64 start = 2;
  repeated GrpcQueryTelemetry steps = 3;
  repeated string arguments = 4;
  int64 spentTime = 5;
}

message GrpcExtraResults {
  map<string, GrpcHistogram> attributeHistogram = 2;
  GrpcHistogram priceHistogram = 3;
  repeated GrpcFacetGroupStatistics facetGroupStatistics = 4;
  GrpcHierarchy selfHierarchy = 5;
  map<string, GrpcHierarchy> hierarchy = 6;
  GrpcQueryTelemetry queryTelemetry = 7;
}